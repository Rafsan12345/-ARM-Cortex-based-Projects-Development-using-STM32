#include "stm32f4xx_hal.h"
#include <string.h>

SPI_HandleTypeDef hspi1;
#define LORA_NSS_Pin GPIO_PIN_4
#define LORA_NSS_GPIO_Port GPIOA

uint8_t tx_data[] = "Hello LoRa!";
uint8_t rx_data[20];

int main(void)
{
    HAL_Init();
    SystemClock_Config();
    MX_GPIO_Init();
    MX_SPI1_Init();

    while(1)
    {
        // Transmit data
        HAL_GPIO_WritePin(LORA_NSS_GPIO_Port, LORA_NSS_Pin, GPIO_PIN_RESET);
        HAL_SPI_Transmit(&hspi1, tx_data, strlen((char*)tx_data), HAL_MAX_DELAY);
        HAL_GPIO_WritePin(LORA_NSS_GPIO_Port, LORA_NSS_Pin, GPIO_PIN_SET);

        HAL_Delay(1000); // wait 1 sec
    }
}
